---
- hosts: "default:localhost"
  connection: "local"
  become: yes
  become_user: "root"
  vars_files:
  - "config.yml"

  roles:
  # update the system to the latest packages
  - role: "system-update"

  # local user preferences
  - role: "local"

  # https://galaxy.ansible.com/geerlingguy/docker
  - role: "geerlingguy.docker"
    docker_users:
    - "vagrant"
    when: install_docker | default(false)

  # https://galaxy.ansible.com/geerlingguy/postgresql
  - role: "geerlingguy.postgresql"
    postgresql_users:
    - name: "vagrant"
      role_attr_flags: "SUPERUSER"
    when: install_pg | default(false)

  # https://galaxy.ansible.com/geerlingguy/nodejs
  - role: "geerlingguy.nodejs"
    nodejs_version: "10.x"
    when: install_node | default(false)

  # https://galaxy.ansible.com/avanov/pyenv
  - role: "avanov.pyenv"
    user: "vagrant"
    version: "3.7.3"
    pyenv_env: "user"
    pyenv_owner: "{{ user }}"
    pyenv_path: "/home/{{ user }}/.pyenv"
    pyenv_virtualenvs: []
    pyenv_python_versions:
    - "{{ version }}"
    pyenv_global: "{{ version }}"
    pyenv_enable_autocompletion: yes
    pyenv_update_git_install: yes
    when: install_pyenv | default(false)

  # https://galaxy.ansible.com/rvm/ruby
  - role: "rvm.ruby"
    rvm1_rubies:
    - "2.6.3"
    rvm1_user: "vagrant"
    when: install_rvm | default(false)

  # https://galaxy.ansible.com/gantsign/golang
  - role: "gantsign.golang"
    golang_version: "1.12.4"
    golang_gopath: "${HOME}/go"
    when: install_go | default(false)

  # https://galaxy.ansible.com/naftulikay/rust-dev
  - role: "naftulikay.rust-dev"
    rust_user: "vagrant"
    rust_version: "1.34.1"
    when: install_rust | default(false)
